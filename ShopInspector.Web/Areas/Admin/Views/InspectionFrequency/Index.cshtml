@model IEnumerable<ShopInspector.Core.Entities.InspectionFrequency>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Inspection Frequencies";
}

<div class="admin-container">
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle-fill"></i> @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }
    
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle-fill"></i> @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <div class="admin-toolbar">
        <h2 class="mb-0">Inspection Frequencies</h2>
        <div class="d-flex justify-content-end mb-4">
            <a asp-area="Admin" asp-controller="InspectionFrequency" asp-action="Create" class="btn btn-primary">
                <i class="bi bi-plus-circle"></i> Add Frequency
            </a>
        </div>
    </div>

    <div class="admin-card">
        <div class="table-responsive">
            <table class="table table-hover table-compact mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Frequency Name</th>
                        <th data-hide-md>ID</th>
                        <th class="text-end">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Any())
                    {
                        @foreach (var f in Model)
                        {
                            <tr data-id="@f.InspectionFrequencyID">
                                <td>
                                    <strong>@f.FrequencyName</strong>
                                </td>
                                <td data-hide-md class="text-muted">#@f.InspectionFrequencyID</td>
                                <td class="text-end">
                                    <a asp-area="Admin" asp-controller="InspectionFrequency" asp-action="Edit" asp-route-id="@f.InspectionFrequencyID" class="btn btn-sm btn-outline-primary me-1">Edit</a>
                                    <button type="button" data-action="delete" data-url="@Url.Action("Delete", "InspectionFrequency", new { area = "Admin", id = f.InspectionFrequencyID })" class="btn btn-sm btn-outline-danger">Delete</button>
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="3" class="text-center text-muted py-4">
                                <h5>No inspection frequencies found</h5>
                                <p>Create your first inspection frequency to get started.</p>
                                <a asp-area="Admin" asp-controller="InspectionFrequency" asp-action="Create" class="btn btn-primary">Add First Frequency</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('[data-action="delete"]').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (confirm('Are you sure you want to delete this frequency?')) {
                        const form = document.createElement('form');
                        form.method = 'POST';
                        form.action = this.getAttribute('data-url');
                        document.body.appendChild(form);
                        form.submit();
                    }
                });
            });
        });
    </script>
}